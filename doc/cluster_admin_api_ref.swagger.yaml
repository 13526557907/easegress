swagger: '2.0'
info:
  title: Ease Gateway Cluster Administration API
  description: Ease Gateway supports cluster APIs on administration panel.
  version: "1.0"
schemes:
  - http
  - https
basePath: /cluster/admin/v1
produces:
  - application/json
paths:
  /{group}/plugin-types:
    get:
      summary: Retrieves Plugin Type in a Group
      description: |
        The Plugin Type retrieve endpoint in the group returns all available
        plugin types the group supports currently. Which can be used to create
        a plugin instance with a special configuration.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pluginTypesRetrieveClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PluginTypesRetrieveClusterRequest'
          required: true
          description: Timeout and consistency flag configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster and plugin types retrieve request parameter.
            Including, invalid group name or timeout is less than 10s.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The retrieve timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: The retrieve results are inconsistent from members of the group.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Plugin types response.
          schema:
            $ref: '#/definitions/PluginTypesRetrieveClusterResponse'
        default:
          description: Unexpected error.
          schema:
            $ref: '#/definitions/Error'
  /{group}/pipeline-types:
    get:
      summary: Retrieves Pipeline Type in a Group
      description: |
        The Pipeline Type retrieve endpoint in the group returns all available
        pipeline types the group supports currently. Which can be used to create
        a pipeline instance with a special configuration.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pipelineTypesRetrieveClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PipelineTypesRetrieveClusterRequest'
          required: true
          description: Timeout and consistency flag configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster and pipeline types retrieve request parameter.
            Including, invalid group name or timeout is less than 10s.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The retrieve timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: The retrieve results are inconsistent from members of the group.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Pipeline types response.
          schema:
            $ref: '#/definitions/PipelineTypesRetrieveClusterResponse'
        default:
          description: Unexpected error.
          schema:
            $ref: '#/definitions/Error'
  /{group}/plugins:
    post:
      summary: Creates Plugin Instance in a Group
      description: |
        The Plugin Instance creation endpoint in the group creates a special
        plugin instance according to the plugin type and the configuration.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pluginCreationClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PluginCreationClusterRequest'
          required: true
          description: |
            Timeout, operation sequence, consistency flag, and plugin type and configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and plugin instance creation request parameter.
            Including, invalid group name, timeout is less than 10s, invalid
            operation sequence, invalid plugin type or invalid configuration
            according to the plugin instance is being created.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The creation timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: |
            Plugin instance with the given name request parameter provided is
            already existing or the operation sequence is out-of-date.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Plugin instance is created successfully in the group.
        202:
          description: Plugin instance is created partially in the group.
    get:
      summary: Retrieves Plugin Instance in a Group
      description: |
        The Plugin Instances retrieve endpoint in the group returns all existing
        plugin instnaces the group has currently.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pluginsRetrieveClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PluginsRetrieveClusterRequest'
          required: true
          description: |
            Timeout, consistency flag, and plugin instance retrieve conditions.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and plugin instances retrieve request parameter.
            Including, invalid group name, timeout is less than 10s,
            invalid plugin type or invalid name pattern.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: The retrieve results are inconsistent from members of the group.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Plugin instance response.
          schema:
            $ref: '#/definitions/PluginsRetrieveClusterResponse'
    put:
      summary: Updates Plugin Instance in a Group
      description: |
        The Plugin Instance update endpoint in the group updates a special
        plugin instance according to the plugin type and the configuration.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pluginUpdateClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PluginUpdateClusterRequest'
          required: true
          description: |
            Timeout, operation sequence, consistency flag, and plugin type and configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and plugin instance update request parameter.
            Including, invalid group name, timeout is less than 10s, invalid
            operation sequence, invalid plugin type or invalid configuration
            according to the plugin instance is being updated.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Plugin instnace not found by given name in the group.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: |
            The operation sequence is out-of-date.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Plugin instance is updated successfully in the group.
        202:
          description: Plugin instance is updated partially in the group.
  /{group}/plugins/{pluginName}:
    get:
      summary: Retrieves Plugin Instance in a Group
      description: |
        The Plugin Instance retrieve endpoint in the group returns an existing
        plugin instnace the group has currently by plugin name.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pluginName
          in: path
          description: Plugin instance name to query.
          required: true
          type: string
        - name: pluginRetrieveClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PluginRetrieveClusterRequest'
          required: true
          description: |
            Timeout and consistency flag configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and plugin instance retrieve request parameter.
            Including, invalid group name, invalid plugin name or timeout is
            less than 10s,
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Plugin instnace not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: The retrieve results are inconsistent from members of the group.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Plugin instances response.
          schema:
            $ref: '#/definitions/PluginSpec'
    delete:
      summary: Deletes Plugin Instance in a Group
      description: |
        The Plugin Instance deletion endpoint in the group deletes an existing
        plugin instnace the group has currently by plugin name.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pluginName
          in: path
          description: Plugin instance name to delete.
          required: true
          type: string
        - name: pluginDeletionClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PluginDeletionClusterRequest'
          required: true
          description: |
            Timeout, operation sequence and consistency flag configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and plugin instance deletion request parameter.
            Including, invalid group name, invalid plugin name, timeout is less
            than 10s or invalid operation sequence.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Plugin instnace not found by given name.
          schema:
            $ref: '#/definitions/Error'
        406:
          description: |
            Plugin instnace could not be deleted by given name since it is used by
            one or more pipelines.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Plugin instance is deleted successfully in the group.
        202:
          description: Plugin instance is deleted partially in the group.
  /{group}/pipelines:
    post:
      summary: Creates Pipeline Instance in a Group
      description: |
        The Pipeline Instance creation endpoint in the group creates a special
        pipeline instance according to the pipeline type and the configuration.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pipelineCreationClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PipelineCreationClusterRequest'
          required: true
          description: |
            Timeout, operation sequence, consistency flag and pipeline type and configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and pipeline instance creation request parameter.
            Including, invalid group name, timeout is less than 10s, invalid
            operation sequence, invalid pipeline type or invalid configuration
            according to the pipeline instance is being created, or one or more
            plugin instances in the pipeline are not found.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: |
            Pipeline instance with the given name request parameter provided is
            already existing, or the operation sequence is out-of-date.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Pipeline instance is created successfully in the group.
        202:
          description: Pipeline instance is created partially in the group.
    get:
      summary: Retrieves Pipeline Instances in a Group
      description: |
        The Pipeline Instances retrieve endpoint in the group returns all existing
        pipeline instnaces the group has currently.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pipelinesRetrieveClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PipelinesRetrieveClusterRequest'
          required: true
          description: |
            Timeout, consistency flag and pipeline instance retrieve conditions.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and pipeline instances retrieve request parameter.
            Including, invalid group name, timeout is less than 10s,
            invalid pipeline type or invalid name pattern.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: The retrieve results are inconsistent from members of the group.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Pipeline instances response.
          schema:
            $ref: '#/definitions/PipelinesRetrieveClusterResponse'
    put:
      summary: Updates Pipeline Instance in a Group
      description: |
        The Pipeline Instance update endpoint in the group updates a special
        pipeline instance according to the pipeline type and the configuration.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pipelineUpdateClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PipelineUpdateClusterRequest'
          required: true
          description: |
            Timeout, operation sequence, consistency flag and pipeline type and configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and pipeline instance update request parameter.
            Including, invalid group name, timeout is less than 10s, invalid
            operation sequence, invalid pipeline type or invalid configuration
            according to the pipeline instance is being updated, or one or more
            plugin instances in the pipeline are not found.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Pipeline instnace not found by given name in the group.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: |
            The operation sequence is out-of-date.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Pipeline instance is updated successfully in the group.
        202:
          description: Pipeline instance is updated partially in the group.
  /{group}/pipelines/{pipelineName}:
    get:
      summary: Retrieves Pipeline Instance in a Group
      description: |
        The Pipeline Instance retrieve endpoint in the group returns an existing
        pipeline instnaces the group has currently by pipeline name.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: pipelineRetrieveClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PipelineRetrieveClusterRequest'
          required: true
          description: |
            Timeout and consistency flag configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and pipeline instance retrieve request parameter.
            Including, invalid group name, invalid pipeline name or timeout is
            less than 10s,
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Pipeline instnace not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        409:
          description: The retrieve results are inconsistent from members of the group.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Pipeline instances response.
          schema:
            $ref: '#/definitions/PipelineSpec'
    delete:
      summary: Deletes Pipeline Instance in a Group
      description: |
        The Pipeline Instance deletion endpoint in the group deletes an existing
        pipeline instnace the group has currently by pipeline name.
      parameters:
        - name: group
          in: path
          required: true
          type: string
        - name: pipelineName
          in: path
          description: Pipeline instance name to delete.
          required: true
          type: string
        - name: pipelineDeletionClusterRequest
          in: body
          schema:
            $ref: '#/definitions/PipelineDeletionClusterRequest'
          required: true
          description: |
            Timeout, operation sequence and consistency flag configurations.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid cluster operation and pipeline instance deletion request parameter.
            Including, invalid group name, invalid pipeline name, timeout is less
            than 10s or invalid operation sequence.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Pipeline instnace not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Pipeline instance is deleted successfully in the group.
        202:
          description: Pipeline instance is deleted partially in the group.
definitions:
  PluginTypesRetrieveClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      consistent:
        type: boolean
        default: false
  PluginTypesRetrieveClusterResponse:
    type: object
    required:
      - plugin_types
    properties:
      plugin_types:
        type: array
        items:
          type: string
  PipelineTypesRetrieveClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      consistent:
        type: boolean
        default: false
  PipelineTypesRetrieveClusterResponse:
    type: object
    required:
      - pipeline_types
    properties:
      pipeline_types:
        type: array
        items:
          type: string
  PluginCreationClusterRequest:
    type: object
    required:
      - operation_seq
      - type
      - config
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      operation_seq:
        type: integer
        minimum: 1
      consistent:
        type: boolean
        default: false
      type:
        type: string
        description: One valid type of available plugin types listed in PluginTypesRetrieveClusterResponse.
      config:
        type: object
        description: |
          A special configuration object of the plugin type. Check Plugin Reference document for
          more information.
  PluginsRetrieveClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      consistent:
        type: boolean
        default: false
      name_pattern:
        type: string
        description: Plugin name filter condition, supports regex expression.
      types:
        type: array
        items:
          type: string
        description: Plugin types filter condition, supports regex expression.
  PluginsRetrieveClusterResponse:
    type: object
    required:
      - plugins
    properties:
      plugins:
        type: array
        items:
          $ref: '#/definitions/PluginSpec'
  PluginUpdateClusterRequest:
    type: object
    required:
      - operation_seq
      - type
      - config
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      operation_seq:
        type: integer
        minimum: 1
      consistent:
        type: boolean
        default: false
      type:
        type: string
        description: One valid type of available plugin types listed in PluginTypesRetrieveClusterResponse.
      config:
        type: object
        description: |
          A special configuration object of the plugin type. Check Plugin Reference document
          for more information.
  PluginRetrieveClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      consistent:
        type: boolean
        default: false
  PluginDeletionClusterRequest:
    type: object
    required:
      - operation_seq
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      operation_seq:
        type: integer
        minimum: 1
      consistent:
        type: boolean
        default: false
  PluginSpec:
    type: object
    required:
      - type
      - config
    properties:
      type:
        type: string
        description: One valid type of available plugin types listed in PluginTypesRetrieveClusterResponse.
      config:
        type: object
        description: |
          A special configuration object of the plugin type. Check Plugin Reference document for
          more information.
  PipelineCreationClusterRequest:
    type: object
    required:
      - operation_seq
      - type
      - config
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      operation_seq:
        type: integer
        minimum: 1
      consistent:
        type: boolean
        default: false
      type:
        type: string
        description: One valid type of available pipeline types listed in PipelineTypesRetrieveClusterResponse.
      config:
        type: object
        description: |
          A special configuration object of the pipeline type. Check Pipeline Reference document for
          more information.
  PipelinesRetrieveClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      consistent:
        type: boolean
        default: false
      name_pattern:
        type: string
        description: Pipeline name filter condition, supports regex expression.
      types:
        type: array
        items:
          type: string
        description: Pipeline types filter condition, supports regex expression.
  PipelinesRetrieveClusterResponse:
    type: object
    required:
      - pipelines
    properties:
      pipelines:
        type: array
        items:
          $ref: '#/definitions/PipelineSpec'
  PipelineUpdateClusterRequest:
    type: object
    required:
      - operation_seq
      - type
      - config
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      operation_seq:
        type: integer
        minimum: 1
      consistent:
        type: boolean
        default: false
      type:
        type: string
        description: One valid type of available pipeline types listed in PipelineTypesRetrieveClusterResponse.
      config:
        type: object
        description: |
          A special configuration object of the pipeline type. Check Pipeline Reference document
          for more information.
  PipelineRetrieveClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      consistent:
        type: boolean
        default: false
  PipelineDeletionClusterRequest:
    type: object
    required:
      - operation_seq
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 30
      operation_seq:
        type: integer
        minimum: 1
      consistent:
        type: boolean
        default: false
  PipelineSpec:
    type: object
    required:
      - type
      - config
    properties:
      type:
        type: string
        description: One valid type of available pipeline types listed in PipelineTypesRetrieveClusterResponse.
      config:
        type: object
        description: |
          A special configuration object of the pipeline type. Check Pipeline Reference document
          for more information.
  Error:
    type: object
    required:
      - Error
    properties:
      Error:
        type: string
