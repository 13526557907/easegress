swagger: '2.0'
info:
  title: Ease Gateway Cluster Statistics API
  description: Ease Gateway supports Cluster APIs for statistics.
  version: "1.0"
schemes:
  - http
  - https
basePath: /cluster/statistics/v1
produces:
  - application/json
paths:
  /{group}/pipelines/{pipelineName}/plugins/{pluginName}/indicators:
    get:
      summary: Retrieves Plugin Statistics Indicator Names in a Group
      description: |
        The Plugin Statistics Indicators retrieve endpoint in the group returns
        the name list of all available statistics indicators plugin instance
        exposed against the pipeline instance.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: pluginName
          in: path
          description: Plugin instance name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, invalid pipeline or plugin instance name to query.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline or plugin instance not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The names of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterPluginIndicatorNames'
  /{group}/pipelines/{pipelineName}/plugins/{pluginName}/indicators/{indicatorName}/value:
    get:
      summary: Retrieves Plugin Statistics Indicator Value in a Group
      description: |
        The Plugin Statistics Indicator Value retrieve endpoint in the gourp returns
        the value of given statistics indicator plugin instance exposed against
        the pipeline instance.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: pluginName
          in: path
          description: Plugin instance name to query.
          required: true
          type: string
        - name: indicatorName
          in: path
          description: Statistics indicator name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s,
            invalid pipeline or plugin instance name or indicator name to query.
          schema:
            $ref: '#/definitions/Error'
        403:
          description: Failed to query value from plugin indicator.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline or plugin instance or indicator not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The value of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterPluginIndicatorValue'
  /{group}/pipelines/{pipelineName}/plugins/{pluginName}/indicators/{indicatorName}/desc:
    get:
      summary: Retrieves Plugin Statistics Indicator Description in a Group
      description: |
        The Plugin Statistics Indicator Description retrieve endpoint in the group
        returns the description of given statistics indicator plugin instance exposed
        against the pipeline instance.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: pluginName
          in: path
          description: Plugin instance name to query.
          required: true
          type: string
        - name: indicatorName
          in: path
          description: Statistics indicator name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s,
            invalid pipeline or plugin instance name or indicator name to query.
          schema:
            $ref: '#/definitions/Error'
        403:
          description: Failed to describe plugin indicator.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline or plugin instance or indicator not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The description of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterPluginIndicatorDescription'
  /{group}/pipelines/{pipelineName}/indicators:
    get:
      summary: Retrieves Pipeline Statistics Indicator Names in a Group
      description: |
        The Pipeline Statistics Indicators retrieve endpoint in the group returns
        the name list of all available statistics indicators pipeline instance exposed.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, or invalid pipeline instance name to query.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The names of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterPipelineIndicatorNames'
  /{group}/pipelines/{pipelineName}/indicators/{indicatorName}/value:
    get:
      summary: Retrieves Pipeline Statistics Indicator Value in a Group
      description: |
        The Pipeline Statistics Indicator Value retrieve endpoint in the group
        returns the value of given statistics indicator pipeline instance exposed.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: indicatorName
          in: path
          description: Statistics indicator name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, invalid pipeline instance name or indicator name to query.
          schema:
            $ref: '#/definitions/Error'
        403:
          description: Failed to query value from pipeline indicator.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance or indicator not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The value of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterPipelineIndicatorValue'
  /{group}/pipelines/{pipelineName}/indicators/{indicatorName}/desc:
    get:
      summary: Retrieves Pipeline Statistics Indicator Description in a Group
      description: |
        The Pipeline Statistics Indicator Description retrieve endpoint in the
        group returns the description of given statistics indicator pipeline
        instance exposed.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: indicatorName
          in: path
          description: Statistics indicator name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, or invalid pipeline or indicator name to query.
          schema:
            $ref: '#/definitions/Error'
        403:
          description: Failed to describe pipeline indicator.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance or indicator not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The description of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterPipelineIndicatorDescription'
  /{group}/pipelines/{pipelineName}/indicators/value:
    get:
      summary: Retrieves Pipeline Statistics Values From Multiple Indicators in a Group
      description: |
        The Pipeline Statistics Indicators Value retrieve endpoint in the group
        returns the values of given multiple statistics indicators pipeline instance exposed.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: pipelineIndicatorsValueRetrieveRequest
          in: body
          schema:
            $ref: '#/definitions/ClusterPipelineIndicatorsValueRetrieveRequest'
          required: true
          description: |
            Timeout, the flag to present if returns the result of each cluster memeber and indicator names to query.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, invalid pipeline instance name or
            invalid indicator names to query.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The values of statistics indicators.
          schema:
            $ref: '#/definitions/ClusterPipelineIndicatorsValue'
  /{group}/pipelines/{pipelineName}/task/indicators:
    get:
      summary: Retrieves Task Statistics Indicator Names in a Group
      description: |
        The Task Statistics Indicators retrieve endpoint in the group returns
        the name list of all available statistics indicators task exposed
        against the pipeline instance.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, orinvalid pipeline instance name to query.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The names of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterTaskIndicatorNames'
  /{group}/pipelines/{pipelineName}/task/indicators/{indicatorName}/value:
    get:
      summary: Retrieves Task Statistics Indicator Value in a Group
      description: |
        The Task Statistics Indicator Value retrieve endpoint in the group returns
        the value of given statistics indicator task exposed against the pipeline instance.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: indicatorName
          in: path
          description: Statistics indicator name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, or invalid pipeline instance name or indicator name to query.
          schema:
            $ref: '#/definitions/Error'
        403:
          description: Failed to query value from task indicator.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance or indicator not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: The value of statistics indicator.
          schema:
            $ref: '#/definitions/ClusterTaskIndicatorValue'
  /{group}/pipelines/{pipelineName}/task/indicators/{indicatorName}/desc:
    get:
      summary: Retrieves Task Statistics Indicator Description in a Group
      description: |
        The Task Statistics Indicator Description retrieve endpoint in the group
        returns the description of given statistics indicator task exposed against
        the pipeline instance.
      parameters:
        - name: group
          in: path
          required: true
          type: string
          description: Group name of cluster to query.
        - name: pipelineName
          in: path
          description: Pipeline instance name to query.
          required: true
          type: string
        - name: indicatorName
          in: path
          description: Statistics indicator name to query.
          required: true
          type: string
        - name: statisticsClusterRequest
          in: body
          schema:
            $ref: '#/definitions/StatisticsClusterRequest'
          required: true
          description: Timeout and the flag to present if returns the result of each cluster memeber.
      responses:
        500:
          description: Handle the reqeuest failed by internal error.
          schema:
            $ref: '#/definitions/Error'
        503:
          description: All operations are disallowed when running in standalone mode.
          schema:
            $ref: '#/definitions/Error'
        400:
          description: |
            Invalid group name, timeout is less than 10s, or invalid pipeline instance name or indicator name to query.
          schema:
            $ref: '#/definitions/Error'
        403:
          description: Failed to describe task indicator.
          schema:
            $ref: '#/definitions/Error'
        404:
          description: The statistics of pipeline instance or indicator not found by given name.
          schema:
            $ref: '#/definitions/Error'
        408:
          description: The timeout period expired.
          schema:
            $ref: '#/definitions/Error'
        410:
          description: The endpoint has gone.
          schema:
            $ref: '#/definitions/Error'
        200:
          description: Timeout and the flag to present if returns the result of each cluster memeber.
          schema:
            $ref: '#/definitions/ClusterTaskIndicatorDescription'
definitions:
  StatisticsClusterRequest:
    type: object
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 120
      detail:
        type: boolean
        default: false
  ClusterPluginIndicatorNames:
    type: object
    required:
      - names
    properties:
      names:
        type: array
        items:
          type: string
# Could be one of (not complete list, plugin might expose one or more own indicator):
# - EXECUTION_COUNT_LAST_1MIN_ALL
# - EXECUTION_COUNT_LAST_1MIN_FAILURE
# - EXECUTION_COUNT_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_50_PERCENT_LAST_1MIN_FAILURE
# - EXECUTION_TIME_50_PERCENT_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_50_PERCENT_LAST_1MIN_ALL
# - EXECUTION_TIME_90_PERCENT_LAST_1MIN_FAILURE
# - EXECUTION_TIME_90_PERCENT_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_90_PERCENT_LAST_1MIN_ALL
# - EXECUTION_TIME_99_PERCENT_LAST_1MIN_FAILURE
# - EXECUTION_TIME_99_PERCENT_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_99_PERCENT_LAST_1MIN_ALL
# - EXECUTION_TIME_MAX_LAST_1MIN_ALL
# - EXECUTION_TIME_MAX_LAST_1MIN_FAILURE
# - EXECUTION_TIME_MAX_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_MIN_LAST_1MIN_ALL
# - EXECUTION_TIME_MIN_LAST_1MIN_FAILURE
# - EXECUTION_TIME_MIN_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_STD_DEV_LAST_1MIN_FAILURE
# - EXECUTION_TIME_STD_DEV_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_STD_DEV_LAST_1MIN_ALL
# - EXECUTION_TIME_VARIANCE_LAST_1MIN_FAILURE
# - EXECUTION_TIME_VARIANCE_LAST_1MIN_SUCCESS
# - EXECUTION_TIME_VARIANCE_LAST_1MIN_ALL
# - THROUGHPUT_RATE_LAST_15MIN_ALL
# - THROUGHPUT_RATE_LAST_15MIN_FAILURE
# - THROUGHPUT_RATE_LAST_15MIN_SUCCESS
# - THROUGHPUT_RATE_LAST_1MIN_ALL
# - THROUGHPUT_RATE_LAST_1MIN_FAILURE
# - THROUGHPUT_RATE_LAST_1MIN_SUCCESS
# - THROUGHPUT_RATE_LAST_5MIN_ALL
# - THROUGHPUT_RATE_LAST_5MIN_FAILURE
# - THROUGHPUT_RATE_LAST_5MIN_SUCCESS
  ClusterIndicatorValue:
    type: object
    description: |
      A special value object of the pipeline indicator type.
      Check Pipeline Reference document for more information.
    properties:
      aggregated_result:
        # NOTICE: Swagger specification2.0/3.0.x doesn't support multiple types currently.
        #         https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#properties
        # type:
        #   - "null"
        #   - "boolean"
        #   - "object"
        #   - "array"
        #   - "number"
        #   - "string"
        description: Aggregated result which could be any type.
      aggregator_name:
        type: string
      detail_values:
        type: object
        description: An object of displaying the detailed value of every cluster member.
        additionalProperties:
          # NOTICE: Swagger specification2.0/3.0.x doesn't support multiple types currently.
          #         https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#properties
          # type:
          #   - "null"
          #   - "boolean"
          #   - "object"
          #   - "array"
          #   - "number"
          #   - "string"
          description: Detailed result which could be any type.
  ClusterPluginIndicatorValue:
    type: object
    required:
      - value
    properties:
      value:
        type: object
        additionalProperties:
          $ref: '#/definitions/ClusterIndicatorValue'
  ClusterPluginIndicatorDescription:
    type: object
    required:
      - desc
    properties:
      desc:
        type: string
        description: |
          A human readable description of the indicator type.
          Check Plugin Reference document for more information.
  ClusterPipelineIndicatorNames:
    type: object
    required:
      - names
    properties:
      names:
        type: array
        items:
          type: string
          enum:
            - EXECUTION_COUNT_LAST_1MIN_ALL
            - EXECUTION_TIME_50_PERCENT_LAST_1MIN_ALL
            - EXECUTION_TIME_90_PERCENT_LAST_1MIN_ALL
            - EXECUTION_TIME_99_PERCENT_LAST_1MIN_ALL
            - EXECUTION_TIME_MAX_LAST_1MIN_ALL
            - EXECUTION_TIME_MIN_LAST_1MIN_ALL
            - EXECUTION_TIME_STD_DEV_LAST_1MIN_ALL
            - EXECUTION_TIME_VARIANCE_LAST_1MIN_ALL
            - THROUGHPUT_RATE_LAST_15MIN_ALL
            - THROUGHPUT_RATE_LAST_1MIN_ALL
            - THROUGHPUT_RATE_LAST_5MIN_ALL
  ClusterPipelineIndicatorValue:
    type: object
    required:
      - value
    properties:
      value:
        type: object
        additionalProperties:
          $ref: '#/definitions/ClusterIndicatorValue'
  ClusterPipelineIndicatorDescription:
    type: object
    required:
      - desc
    properties:
      desc:
        type: string
        description: |
          A human readable description of the special plugin indicator type.
          Check Pipeline Reference document for more information.
  ClusterPipelineIndicatorsValueRetrieveRequest:
    type: object
    required:
      - indicator_names
    properties:
      timeout_sec:
        type: integer
        minimum: 10
        maximum: 65535
        default: 120
      detail:
        type: boolean
        default: false
      indicator_names:
        type: array
        items:
          type: string
          description: The name of the indicator to query statistics value.
  ClusterPipelineIndicatorsValue:
    type: object
    required:
      - values
    properties:
      values:
        type: object
        additionalProperties:
          $ref: '#/definitions/ClusterIndicatorValue'
  ClusterTaskIndicatorNames:
    type: object
    required:
      - names
    properties:
      names:
        type: array
        items:
          type: string
          enum:
            - EXECUTION_COUNT_ALL
            - EXECUTION_COUNT_FAILURE
            - EXECUTION_COUNT_SUCCESS
  ClusterTaskIndicatorValue:
    type: object
    required:
      - value
    properties:
      value:
        type: object
        additionalProperties:
          $ref: '#/definitions/ClusterIndicatorValue'
  ClusterTaskIndicatorDescription:
    type: object
    required:
      - desc
    properties:
      desc:
        type: string
        description: |
          A human readable description of the special task indicator type.
          Check Pipeline Reference document for more information.
  Error:
    type: object
    required:
      - Error
    properties:
      Error:
        type: string
