name: circuitbreaker-proxy-example
kind: HTTPProxy
# By order: validator, fallback, rateLimiter, requestAdaptor, backend, responseAdaptor
backend:
  failureCodes:
    - 503
  fallback:
    forCircuitBreaker: true
    forCodes: false
    mockCode: 504
    mockHeaders: {}
  mainPool:
    circuitBreaker:
      countPeriod: 1s
      toClosedConsecutiveCounts: 50
      toHalfOpenTimeout: 5s
      toOpenFailureConsecutiveCounts: 50
      toOpenFailureCounts: 100
    servers:
    - url: http://127.0.0.1:9098
    loadBalance:
      policy: roundRobin

